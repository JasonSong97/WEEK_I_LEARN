# ğŸ“Select, Insert, Update and Delete

## basic syntax

```sql
SELECT `id`, `name` FROM `new_schema`.`users`;
```

sample data

```sql
CREATE SCHEMA `new_schema` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

CREATE TABLE `new_schema`.`users` (
  `id` INT NOT NULL AUTO_INCREMENT COMMENT 'This is the primary index',
  `name` VARCHAR(45) NOT NULL DEFAULT 'N/A',
  `age` INT NULL,
  `height` INT NULL,
  PRIMARY KEY (`id`)
);

INSERT INTO `new_schema`.`users` (`id`, `name`, `age`, `height`) VALUES (1, 'John', 50, 180);
INSERT INTO `new_schema`.`users` (`id`, `name`, `age`) VALUES (2, 'May', 40);
INSERT INTO `new_schema`.`users` (`id`, `name`, `age`, `height`) VALUES (3, 'Tim', 10, 170);
INSERT INTO `new_schema`.`users` (`id`, `name`, `age`, `height`) VALUES (4, 'Jay', 20, 155);
```

![alt text](image/image-4.png)

## create: insert

```sql
INSERT INTO `new_schema`.`users` (`id`, `name`, `age`) VALUES (4, 'Harry', 33);
```

- multi create

```sql
INSERT INTO `new_schema`.`users` (`id`, `name`, `age`) VALUES (4, 'Harry', 33), (5, 'Tom', 30);
```

![alt text](image/image-5.png)

## read: select

```sql
SELECT `id`, `name` FROM `new_schema`.`users`;
```

- ì „ì²´ ì¡°íšŒ

```sql
SELECT * FROM `new_schema`.`users`;
```

### condition

```sql
SELECT * FROM `new_schema`.`users` WHERE `id` = 2;
```

## modify: update

```sql
UPDATE `new_schema`.`users` SET `name` = 'Andy', `age` = 100 WHERE `id` = 2;
```

whereì ˆì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´, ì „ì²´ë¥¼ ìˆ˜ì •í•œë‹¤.

## remove: delete

```sql
DELETE FROM `new_schema`.`users` WHERE `id` = 1;
```

# ğŸ“Where

## basic condition

### equal to, greater than, and less than

```sql
SELECT * FROM `new_schema`.`users` WHERE id = 1;
SELECT * FROM `new_schema`.`users` WHERE id > 2;
SELECT * FROM `new_schema`.`users` WHERE id <= 1;
SELECT * FROM `new_schema`.`users` WHERE id != 1;
```

### null

```sql
SELECT * FROM `new_schema`.`users` WHERE height IS NULL;
SELECT * FROM `new_schema`.`users` WHERE height IS NOT NULL;
```

## mutiple condition

### and

```sql
SELECT * FROM `new_schema`.`users` WHERE age < 40 AND height > 160;
```

### or

```sql
SELECT * FROM `new_schema`.`users` WHERE age < 40 OR height > 160;
```

### and + or

```sql
SELECT * FROM `new_schema`.`users` WHERE id < 4 AND (age > 30 OR height > 175);
```

## range condition

### in

```sql
SELECT * FROM `new_schema`.`users` WHERE `id` IN (1, 3);
SELECT * FROM `new_schema`.`users` WHERE id NOT IN (1, 4);
```

### between

```sql
SELECT * FROM `new_schema`.`users` WHERE height BETWEEN 160 AND 190;
```

### like

```sql
SELECT * FROM `new_schema`.`users` WHERE name LIKE '%a%'; // ì¤‘ê°„ì— aê°€ ë“¤ì–´ê°€ëŠ” ê²ƒ
SELECT * FROM `new_schema`.`users` WHERE name LIKE 'J%'; // ì‹œì‘ì´ Jë¡œ ì‹œì‘í•˜ëŠ” ê²ƒ
SELECT * FROM `new_schema`.`users` WHERE name LIKE '%y'; // ëì´ yë¡œ ëë‚˜ëŠ” ê²ƒ
```

# ğŸ“Json in SQL

```sql
ALTER TABLE `new_schema`.`users` ADD COLUMN `contact` JSON NULL AFTER `id`;
```

sample data

```sql
CREATE SCHEMA `new_schema` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

CREATE TABLE `new_schema`.`users` (
  `id` INT NOT NULL AUTO_INCREMENT COMMENT 'This is the primary index',
  `name` VARCHAR(45) NOT NULL DEFAULT 'N/A',
  PRIMARY KEY (`id`)
);

ALTER TABLE `new_schema`.`users` ADD COLUMN `contact` JSON NULL AFTER `id`;

INSERT INTO `new_schema`.`users` (`id`, `name`, `contact`) VALUES 
  (1, 'John', JSON_OBJECT('phone', '123-456', 'address', 'New York')),
  (2, 'May', JSON_OBJECT('phone', '888-99', 'address', 'LA')),
  (3, 'Tim', JSON_OBJECT('phone', '1236')),
  (4, 'Jay', JSON_OBJECT('phone', '321-6', 'address', 'Boston'));
```

## json

[json](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/JSON)

- Json í˜•ì‹

```json
{
    "orderId": 54321,
    "info": [
        {
            "productID": 34,
            "productName": "productOne",
            "quantity": 1
        },
        {
            "productID": 56,
            "productName": "productTwo",
            "quantity": 3
        },
    ],
    "orderCompleted": true
}
```

## read json data

- ë”°ì˜´í‘œ ìˆìŒ
```sql
SELECT `id`, JSON_EXTRACT(contact, '$.phone') AS phone
FROM `new_schema`.`users`;
```

![alt text](image/image-6.png)

- ë”°ì˜´í‘œ ì—†ìŒ

```sql
SELECT `id`, JSON_UNQUOTE(JSON_EXTRACT(contact, '$.phone')) AS phone
FROM `new_schema`.`users`;
```

![alt text](image/image-7.png)

- json ë°ì´í„°ì—ì„œ 456ì„ í¬í•¨í•œ ë°ì´í„°ë¥¼ ì°¾ê³  ì‹¶ì„ ë•Œ

```sql
SELECT `id`, JSON_UNQUOTE(JSON_EXTRACT(contact, '$.phone')) AS phone
FROM `new_schema`.`users`
WHERE JSON_EXTRACT(contact, '$.phone') like '%456%';
```

![alt text](image/image-8.png)

## add json data

```sql
INSERT INTO `new_schema`.`users` (`id`, `name`, `contact`) VALUES (5, 'Harry', JSON_OBJECT('phone', '1231123', 'address', 'Miami'));
```

![alt text](image/image-9.png)

## update json data

```sql
UPDATE `new_schema`.`users` SET `contact` = JSON_SET(contact, '$.phone', '6666', '$.phone_2', '888') WHERE `id` = 2;
```

![alt text](image/image-10.png)

# ğŸ“Auxiliary select Statements

sample data

```sql
CREATE SCHEMA `new_schema` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

CREATE TABLE `new_schema`.`users` (
  `id` INT NOT NULL AUTO_INCREMENT COMMENT 'This is the primary index',
  `name` VARCHAR(45) NOT NULL DEFAULT 'N/A',
  `age` INT NULL,
  `height` INT NULL,
  PRIMARY KEY (`id`)
);

INSERT INTO `new_schema`.`users` (`id`, `name`, `age`, `height`) VALUES 
  (1, 'John', 40, 150),
  (2, 'May', 30, 140),
  (3, 'Tim', 25, 170),
  (4, 'Jay', 60, 185),
  (5, 'Maria', 30, 190),
  (6, 'Tom', 53, 200),
  (7, 'Carter', 40, 145);
```

## uniqueness: distinct

```sql
SELECT DISTINCT age FROM `new_schema`.`users`;
```

## pagination: limit & offset

```sql
SELECT * FROM `new_schema`.`users` LIMIT 3 OFFSET 1;
```

![alt text](image/image-11.png)

```sql
SELECT * FROM `new_schema`.`users` LIMIT 3 OFFSET 0;
SELECT * FROM `new_schema`.`users` LIMIT 3 OFFSET 3;
SELECT * FROM `new_schema`.`users` LIMIT 3 OFFSET 6;
```

![alt text](image/image-12.png)

## sorting: order

```sql
SELECT * FROM `new_schema`.`users` ORDER BY age;
SELECT * FROM `new_schema`.`users` ORDER BY age ASC;
SELECT * FROM `new_schema`.`users` ORDER BY age DESC;
```

- multi column sorting

```sql
SELECT * FROM `new_schema`.`users` ORDER BY age DESC, height DESC;
```

## grouping: group by

distinctì™€ ê°™ì•„ ë³´ì´ì§€ë§Œ group byëŠ” Aggregate functionë¥¼ ë„ì™€ì¤€ë‹¤.

```sql
SELECT `age` FROM `new_schema`.`users` GROUP BY age; // distinctì™€ ë™ì¼í•œ ê²°ê³¼ë¥¼ ê°€ì ¸ì™”ìŒ
```

- ì§ˆë¬¸: how many records there are in each age group

```sql
SELECT COUNT(*), `age` FROM `new_schema`.`users` GROUP BY age;
```

![alt text](image/image-14.png)

```sql
SELECT COUNT(*) AS `age_count`, `age`
FROM `new_schema`.`users`
GROUP BY age
ORDER BY `age_count`;
```

![alt text](image/image-13.png)

# ğŸ“Aggregate function

sample data

```sql
CREATE SCHEMA `new_schema` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

CREATE TABLE `new_schema`.`users` (
  `id` INT NOT NULL AUTO_INCREMENT COMMENT 'This is the primary index',
  `name` VARCHAR(45) NOT NULL DEFAULT 'N/A',
  `age` INT NULL,
  `height` INT NULL,
  PRIMARY KEY (`id`)
);

INSERT INTO `new_schema`.`users` (`id`, `name`, `age`, `height`) VALUES 
  (1, 'John', 40, 150),
  (2, 'May', 30, 140),
  (3, 'Tim', 25, 180),
  (4, 'Jay', 40, 160);
```

## count

```sql
SELECT COUNT(*) AS `user_count` FROM `new_schema`.`users` WHERE id > 1;
```

## sum

```sql
SELECT SUM(`age`) AS `sum_of_user_ages` FROM `new_schema`.`users`;
```

## avg

```sql
SELECT AVG(`height`) AS `avg_user_height` FROM `new_schema`.`users`;
```

## min, max

```sql
SELECT MIN(`height`) AS `user_min` FROM `new_schema`.`users`;
SELECT MAX(`height`) AS `user_max` FROM `new_schema`.`users`;
```

## other functions

### concat()

concatì€ ë‹¨ì–´ë¥¼ ì¡°í•©í•˜ëŠ” ê²ƒ. ë°‘ì— ë³´ë©´ idë‘ nameì„ ì¡°í•©í•˜ëŠ” ê²ƒì„.

```sql
SELECT CONCAT(`id`, '-', `name`) AS `identification`, `age` FROM `new_schema`.`users`;
```

![alt text](image/image-15.png)

í•˜ì§€ë§Œ concatì„ ì‚¬ìš©í•´ì„œ ë§Œë“  columnì€ where `%J%` ê°™ì€ ê¸°ëŠ¥ì„ í•˜ì§€ ëª»í•œë‹¤.

`ì™œëƒí•˜ë©´ whereì ˆì€ ì´ë¯¸ tableì— ì¡´ì¬í•˜ëŠ” columnë§Œ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì´ë‹¤. ë”°ë¼ì„œ ì¡°í•©ì„ í†µí•´ì„œ ë§Œë“¤ì–´ì§„ identificationì—ëŠ” whereì ˆì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.`

í•˜ì§€ë§Œ ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ ì°¾ëŠ” ë°©ë²•ì´ ê°€ëŠ¥í•˜ë‹¤. ë°”ë¡œ `having`ì„ ì´ìš©í•˜ëŠ” ê²ƒì´ë‹¤.

```sql
SELECT CONCAT(`id`, '-', `name`) AS `identification`, `age` FROM `new_schema`.`users`
HAVING `identification` LIKE '%J%';
```

![alt text](image/image-16.png)

`whereì™€ havingì€ ë¹„ìŠ·í•œ ê¸°ëŠ¥ì„ í•œë‹¤. í•˜ì§€ë§Œ havingì„ ì‚¬ìš©í•˜ë©´ ì„±ëŠ¥ì´ ë–¨ì–´ì§„ë‹¤. ë”°ë¼ì„œ whereë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.`